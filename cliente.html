<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rifa - Cliente</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <p class="texto_video">
        A bike do Victor foi roubada a uma semana, era uma das<br>
        poucas coisas que o ajudava na luta contra a obesidade
    </p>
    <video src="imagens/video1.mp4" controls class="video-player"></video>
    <img src="imagens/fundo2.png" controls class="img_premio"></img>
    <img src="imagens/gif_bike.gif" controls class="img_gif"></img>
    <img src="imagens/gif_bike.gif" controls class="img_gif2"></img>
    <div class="container">
        
        <h1 class="primeiro_texto"> Rifa do Victor:</h1>
        <form id="raffle-form">
            <label for="name">Nome</label>
            <input type="text" id="name" name="name" required>

            <label for="phone">Telefone</label>
            <input type="text" id="phone" name="phone" required>

            <label for="email">Email (opcional)</label>
            <input type="email" id="email" name="email">

            <label for="number">Número</label>
            <select id="number" name="number" required>
                <!-- Números disponíveis serão preenchidos aqui pelo JavaScript -->
            </select>

            <button type="submit">Confirmar</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializa os números disponíveis se não estiverem no localStorage
            if (!localStorage.getItem('raffleData')) {
                const initialData = [];
                for (let i = 1; i <= 1000; i++) {
                    initialData.push({ numero: i, disponibilidade: true, nome: '', email: '', telefone: '' });
                }
                localStorage.setItem('raffleData', JSON.stringify(initialData));
            }

            const raffleData = JSON.parse(localStorage.getItem('raffleData'));
            const availableNumbers = raffleData.filter(item => item.disponibilidade);

            const select = document.getElementById('number');
            availableNumbers.forEach(item => {
                const option = document.createElement('option');
                option.value = item.numero;
                option.textContent = item.numero;
                select.appendChild(option);
            });

            document.getElementById('raffle-form').addEventListener('submit', function(e) {
                e.preventDefault();

                const name = document.getElementById('name').value;
                const phone = document.getElementById('phone').value;
                const email = document.getElementById('email').value;
                const number = parseInt(document.getElementById('number').value);

                const index = raffleData.findIndex(item => item.numero === number);
                if (index !== -1 && raffleData[index].disponibilidade) {
                    raffleData[index].disponibilidade = false;
                    raffleData[index].nome = name;
                    raffleData[index].telefone = phone;
                    raffleData[index].email = email;

                    localStorage.setItem('raffleData', JSON.stringify(raffleData));
                    alert('Número confirmado com sucesso!');
                    location.reload(); // Recarrega a página após a confirmação
                } else {
                    alert('Erro ao confirmar número. Tente novamente.');
                }
            });
        });
    </script>
</body>
</html>
